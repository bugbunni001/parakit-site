<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîñ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Sidebar Scroll */
        * { box-sizing: border-box; font-family: 'Kanit', sans-serif !important; }
        body { margin: 0; background: #f8fafc; padding-bottom: 80px; color: #334155; }
        .top-toggle { position: fixed; top: 15px; left: 15px; z-index: 1400; width: 45px; height: 45px; border-radius: 12px; border: none; background: #1e293b; color: #fff; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        
        .sidebar { 
            position: fixed; top: 0; left: 0; width: 260px; height: 100vh; 
            background: #1e293b; color: #fff; transform: translateX(-260px); 
            transition: 0.3s; z-index: 2000; 
            overflow-y: auto; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏î‡∏π‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ */
        }
        .sidebar.show { transform: translateX(0); }
        .content { padding: 80px 20px 40px; transition: 0.3s; }
        @media(min-width:769px) { .sidebar { transform: translateX(0); } .content { margin-left: 260px; } .top-toggle { display: none; } }
        
        .overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.6); display: none; z-index: 1500; }
        .overlay.show { display: block; }

        /* Sidebar Menu Style */
        .menu a, .drop-btn { width: 100%; padding: 15px 20px; background: none; border: none; color: #cbd5e1; text-align: left; font-size: 15px; cursor: pointer; display: flex; align-items: center; text-decoration: none; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .sub { display: none; background: #0f172a; }
        .item.open .sub { display: block; } /* ‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏á */
        .item.open .arrow { transform: rotate(90deg); }
        .arrow { margin-left: auto; transition: 0.3s; }

        /* Form Style */
        .box { max-width: 600px; margin: auto; background: #fff; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .form-row { display: grid; grid-template-columns: 120px 1fr; gap: 10px; margin-bottom: 15px; align-items: center; }
        input, select { padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; }
        .btn-submit { width: 100%; padding: 15px; background: #5bbf8a; color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; }
        
        /* Popup & Loading */
        .loading { position: fixed; inset: 0; background: rgba(255,255,255,0.8); display: none; align-items: center; justify-content: center; z-index: 3000; }
    </style>
</head>
<body>

<button class="top-toggle" onclick="toggleSidebar()">‚ò∞</button>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<aside class="sidebar" id="sidebar"></aside>

<div class="content">
    <div class="box">
        <h3 style="text-align: center;">üìä ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3>
        <div class="form-row"><label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢</label><input type="date" id="date"></div>
        <div class="form-row"><label>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label><select id="staff"><option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô --</option><option>‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£</option><option>‡∏ô‡∏ß‡∏û‡∏•</option><option>‡∏Å‡∏£‡∏ó‡∏±‡∏Å‡∏©‡πå</option></select></div>
        <div class="form-row"><label>‡∏Ñ‡∏ô‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ</label><select id="seller"><option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>‡πÇ‡∏î‡πâ</option><option>‡∏°‡∏¥‡πâ‡∏ô</option><option>‡∏ï‡∏±‡πâ‡∏°</option></select></div>
        <div class="form-row"><label>Postpay</label><select id="type"><option value="">-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option><option>New Rahu</option><option>BDBC</option></select></div>
        <div class="form-row"><label>‡∏¢‡∏≠‡∏î Postpay</label><input type="number" id="amount" placeholder="‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô"></div>
        <div class="form-row"><label>‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ Device</label><select id="device"><option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>iPhone</option><option>Samsung</option></select></div>
        <div class="form-row"><label>‡∏¢‡∏≠‡∏î Device</label><input type="number" id="deviceAmount" placeholder="‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô"></div>
        <div class="form-row"><label>‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠</label><select id="credit_field"><option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option><option>Samsung Finance+</option><option>True Paynext Extra</option></select></div>
        <button class="btn-submit" onclick="submitData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>
</div>

<div class="loading" id="loading">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...</div>

<script>
    // ‡∏ô‡∏≥ URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Google Apps Script (Deployment) ‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxVLyklE7Cht_ADvV_U6x4zcTnTWfCkgIRSgw0mEtm7lmlXO31vbrg2iCEHPLD2FTKjRA/exec"; 

    function toggleSidebar() {
        document.getElementById("sidebar").classList.toggle("show");
        document.getElementById("overlay").classList.toggle("show");
    }

    // ‡πÇ‡∏´‡∏•‡∏î Sidebar ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏Ñ‡πà‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏á‡∏≠‡∏≠‡∏Å
    function includeSidebar() {
        fetch('sidebar.html')
            .then(res => res.text())
            .then(data => {
                document.getElementById('sidebar').innerHTML = data;
                restoreMenu(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏á‡πÑ‡∏ß‡πâ
            });
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π Sidebar (‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå sidebar.html)
    window.toggleDrop = function(btn, id) {
        const item = btn.parentElement;
        const isOpen = item.classList.toggle("open");
        localStorage.setItem('menu-' + id, isOpen); // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
    }

    function restoreMenu() {
        // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ (‡πÄ‡∏ä‡πà‡∏ô 'credit', 'branch')
        ['credit', 'branch'].forEach(id => {
            if (localStorage.getItem('menu-' + id) === 'true') {
                const el = document.getElementById('menu-' + id);
                if (el) el.classList.add('open');
            }
        });
    }

    function submitData() {
        const loading = document.getElementById("loading");
        loading.style.display = "flex";

        const payload = {
            date: document.getElementById("date").value,
            staff: document.getElementById("staff").value,
            seller: document.getElementById("seller").value,
            type: document.getElementById("type").value,
            amount: document.getElementById("amount").value,
            device: document.getElementById("device").value,
            deviceAmount: document.getElementById("deviceAmount").value,
            credit: document.getElementById("credit_field").value
        };

        // ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS
        fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors", 
            body: JSON.stringify(payload)
        })
        .then(() => {
            loading.style.display = "none";
            alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
            location.reload();
        })
        .catch(err => {
            loading.style.display = "none";
            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err);
        });
    }

    window.onload = includeSidebar;
    document.getElementById("date").value = new Date().toISOString().split("T")[0];
</script>
</body>
</html>

