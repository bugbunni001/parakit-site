<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîñ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô - Prachauthit</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* ===== CSS ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÉ‡∏´‡∏°‡πà (‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° + ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Sidebar) ===== */
        :root { 
            --primary: #1e293b; 
            --accent: #5bbf8a; 
            --bg: #f1f5f9; 
            --white: #ffffff;
        }

        * { box-sizing: border-box; font-family: 'Kanit', sans-serif !important; }
        
        body { 
            margin: 0; 
            background: var(--bg); 
            color: #334155; 
            -webkit-font-smoothing: antialiased;
        }

        /* Sidebar ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ */
        .sidebar { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 260px; 
            height: 100vh; 
            background: var(--primary); 
            color: #fff; 
            overflow-y: auto; 
            transform: translateX(-260px); 
            transition: all .3s cubic-bezier(0.4, 0, 0.2, 1); 
            z-index: 2000; 
        }
        .sidebar.show { transform: translateX(0); }
        
        .top-toggle { 
            position: fixed; 
            top: 15px; 
            left: 15px; 
            z-index: 1400; 
            width: 45px; 
            height: 45px; 
            border-radius: 12px; 
            border: none; 
            background: var(--primary); 
            color: #fff; 
            font-size: 20px; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .content { padding: 80px 20px 40px; transition: margin-left .3s; }

        @media(min-width:769px) { 
            .sidebar { transform: translateX(0); } 
            .content { margin-left: 260px; } 
            .top-toggle { display: none; } 
        }

        /* ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà (Form Card) */
        .box { 
            max-width: 700px; 
            margin: auto; 
            background: var(--white); 
            padding: 35px; 
            border-radius: 24px; 
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05); 
            border: 1px solid #e2e8f0;
        }

        .box h3 { 
            margin: 0 0 30px 0; 
            text-align: center; 
            color: var(--primary); 
            font-size: 24px; 
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* Form Layout ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö Grid */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .full-width { grid-column: span 2; }

        label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 500; 
            font-size: 14px; 
            color: #64748b; 
        }

        input, select { 
            width: 100%; 
            padding: 12px 15px; 
            font-size: 15px; 
            border: 1.5px solid #e2e8f0; 
            border-radius: 12px; 
            outline: none; 
            transition: all 0.2s; 
            background-color: #f8fafc; 
        }

        input:focus, select:focus { 
            border-color: var(--accent); 
            background-color: #fff; 
            box-shadow: 0 0 0 4px rgba(91, 191, 138, 0.1); 
        }

        .btn-submit { 
            width: 100%; 
            padding: 18px; 
            font-size: 18px; 
            margin-top: 30px; 
            background: var(--accent); 
            color: white; 
            border: none; 
            border-radius: 15px; 
            cursor: pointer; 
            font-weight: 600; 
            transition: all 0.3s ease; 
            box-shadow: 0 10px 15px -3px rgba(91, 191, 138, 0.3); 
        }

        .btn-submit:hover { 
            background: #4eab7a; 
            transform: translateY(-2px); 
            box-shadow: 0 15px 20px -3px rgba(91, 191, 138, 0.4);
        }

        .overlay { 
            position: fixed; 
            inset: 0; 
            background: rgba(15, 23, 42, 0.6); 
            display: none; 
            backdrop-filter: blur(4px); 
            z-index: 1500; 
        }
        .overlay.show { display: block; }

        .loading { 
            position: fixed; 
            inset: 0; 
            background: rgba(255,255,255,0.8); 
            display: none; 
            align-items: center; 
            justify-content: center; 
            z-index: 9999; 
        }
        
        .spinner {
            width: 40px; height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        @media (max-width: 600px) {
            .form-grid { grid-template-columns: 1fr; }
            .full-width { grid-column: span 1; }
            .box { padding: 25px; }
        }

        footer { 
            width: 100%; 
            text-align: center; 
            padding: 20px; 
            color: #94a3b8; 
            font-size: 12px; 
        }
    </style>
</head>

<body>

<button class="top-toggle" onclick="toggleSidebar()">‚ò∞</button>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<aside class="sidebar" id="sidebar"></aside>

<div class="content">
    <div class="box">
        <h3>üìä ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏¢‡∏≠‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö)</h3>
        
        <div class="form-grid">
            <div class="full-width">
                <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢</label>
                <input type="date" id="date">
            </div>

            <div>
                <label>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                <select id="staff">
                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô --</option>
                    <option value="‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£">‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£</option>
                    <option value="‡∏ô‡∏ß‡∏û‡∏•">‡∏ô‡∏ß‡∏û‡∏•</option>
                    <option value="‡∏Å‡∏£‡∏ó‡∏±‡∏Å‡∏©‡πå">‡∏Å‡∏£‡∏ó‡∏±‡∏Å‡∏©‡πå</option>
                </select>
            </div>

            <div>
                <label>‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ</label>
                <select id="seller">
                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                    <option value="‡πÇ‡∏î‡πâ">‡πÇ‡∏î‡πâ</option>
                    <option value="‡∏°‡∏¥‡πâ‡∏ô">‡∏°‡∏¥‡πâ‡∏ô</option>
                    <option value="‡∏ï‡∏±‡πâ‡∏°">‡∏ï‡∏±‡πâ‡∏°</option>
                </select>
            </div>

            <div>
                <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Postpay</label>
                <select id="type">
                    <option value="">-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
                    <option>New Sim Only</option><option>Mg Sim Only</option><option>New Rahu</option>
                    <option>New ‡∏û‡∏•‡∏±‡∏á‡∏î‡∏≤‡∏ß</option><option>New MyPlan</option><option>New/Mg Bundling</option>
                    <option>Mnp</option><option>BDBC</option>
                </select>
            </div>

            <div>
                <label>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô Postpay</label>
                <input type="number" id="amount" placeholder="0.00">
            </div>

            <div>
                <label>‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ Device</label>
                <select id="device">
                    <option value="">-- ‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ --</option>
                    <option>iPhone</option><option>iPad</option><option>Samsung</option>
                    <option>Xiaomi</option><option>Realme</option><option>Oppo</option>
                    <option>Vivo</option><option>Honor</option><option>Infinix</option>
                    <option>Alldocube</option><option>Accessaries</option>
                </select>
            </div>

            <div>
                <label>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô Device</label>
                <input type="number" id="deviceAmount" placeholder="0.00">
            </div>

            <div class="full-width">
                <label>‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                <select id="credit_field">
                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠ --</option>
                    <option>SG Finance+</option><option>True Paynext Extra</option>
                    <option>Samsung Finance+</option><option>Umay+</option>
                </select>
            </div>
        </div>

        <button type="button" class="btn-submit" onclick="submitData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
    
    <footer>¬© 2026 Prachauthit Sales System</footer>
</div>

<div class="loading" id="loading"><div class="spinner"></div></div>

<script>
// ‚ö†Ô∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç URL ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxPMI90b9jebkOy_8L_Hc6m6LGgeDndsi9_PYMtWontz1ekopMDJDn6fnDYnQFBPDRBgQ/exec";

/* 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Sidebar */
function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("show");
    document.getElementById("overlay").classList.toggle("show");
}

function includeSidebar() {
    fetch('sidebar.html')
        .then(res => res.text())
        .then(data => {
            document.getElementById('sidebar').innerHTML = data;
            // ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô sidebar.html ‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô restoreState ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            if (window.restoreMenuState) window.restoreMenuState();
        })
        .catch(err => console.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î sidebar.html ‡πÑ‡∏î‡πâ"));
}

/* 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤) */
function submitData() {
    const staff = document.getElementById("staff").value;
    if (!staff) {
        alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å!");
        return;
    }

    document.getElementById("loading").style.display = "flex";

    const payload = {
        date: document.getElementById("date").value,
        staff: staff,
        seller: document.getElementById("seller").value,
        type: document.getElementById("type").value,
        amount: document.getElementById("amount").value,
        device: document.getElementById("device").value,
        deviceAmount: document.getElementById("deviceAmount").value,
        credit: document.getElementById("credit_field").value
    };

    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö JSON
    fetch(SCRIPT_URL, {
        method: "POST",
        mode: "no-cors", // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î CORS ‡∏Ç‡∏≠‡∏á Google
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
    })
    .then(() => {
        document.getElementById("loading").style.display = "none";
        alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!");
        location.reload(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤
    })
    .catch(err => {
        document.getElementById("loading").style.display = "none";
        alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err);
    });
}

// ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
window.onload = () => {
    includeSidebar();
    document.getElementById("date").value = new Date().toISOString().split("T")[0];
};
</script>
</body>
</html>

