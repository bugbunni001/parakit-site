<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üîñ ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô & ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</title>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">

<style>
/* ====== CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ ====== */
* { box-sizing: border-box; font-family: 'Kanit', sans-serif !important; }
body { margin:0; background:#f8fafc; padding-bottom:100px; color:#334155; }
.box { max-width:650px; margin:auto; background:#fff; padding:30px; border-radius:24px; }
.form-row { display:grid; grid-template-columns:140px 1fr; gap:12px; margin-bottom:15px; }
.form-row-multi { display:grid; grid-template-columns:140px 1fr 1fr; gap:10px; margin-bottom:15px; }
label { text-align:right; }
input, select { padding:10px; border-radius:10px; border:1px solid #e2e8f0; }
.btn-submit { width:100%; padding:16px; background:#5bbf8a; color:#fff; border:none; border-radius:12px; cursor:pointer; }
.loading { position:fixed; inset:0; background:rgba(255,255,255,.9); display:none; align-items:center; justify-content:center; flex-direction:column; z-index:9999; }
.spinner { width:40px; height:40px; border:4px solid #eee; border-top:4px solid #5bbf8a; border-radius:50%; animation:spin 1s linear infinite; }
@keyframes spin { to{ transform:rotate(360deg); } }
.popup { position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:10000; }
.popup-box { background:#fff; padding:30px; border-radius:20px; text-align:center; }
.success .check { display:block; }
.error .warn { display:block; }
.check, .warn { display:none; font-size:50px; }
</style>
</head>

<body>

<div class="box">
<h3>üìä ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3>

<div class="form-row">
<label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
<input type="date" id="date">
</div>

<div class="form-row">
<label>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
<select id="staff">
<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
<option>‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£</option>
<option>‡∏ô‡∏ß‡∏û‡∏•</option>
<option>‡∏Å‡∏£‡∏ó‡∏±‡∏Å‡∏©‡πå</option>
</select>
</div>

<div class="form-row">
<label>‡∏Ñ‡∏ô‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ</label>
<select id="seller">
<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
<option>‡πÇ‡∏î‡πâ</option>
<option>‡∏°‡∏¥‡πâ‡∏ô</option>
<option>‡∏ï‡∏±‡πâ‡∏°</option>
</select>
</div>

<div class="form-row-multi">
<label>Postpay</label>
<select id="type">
<option value="">-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
<option>New Sim Only</option>
<option>Mnp</option>
</select>
<input type="number" id="amount">
</div>

<div class="form-row-multi">
<label>Device</label>
<select id="device">
<option value="">-- ‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ --</option>
<option>iPhone</option>
<option>Samsung</option>
</select>
<input type="number" id="deviceAmount">
</div>

<div class="form-row">
<label>‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠</label>
<select id="credit_field">
<option value="">-- ‡πÑ‡∏°‡πà‡∏°‡∏µ --</option>
<option>SG Finance+</option>
</select>
</div>

<button class="btn-submit" onclick="submitData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
</div>

<div class="loading" id="loading">
<div class="spinner"></div>
<div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
</div>

<div class="popup" id="popup">
<div class="popup-box" id="pBox">
<div class="check">‚úÖ</div>
<div class="warn">‚ö†Ô∏è</div>
<h3 id="popupText"></h3>
<button onclick="closePopup()">‡∏ï‡∏Å‡∏•‡∏á</button>
</div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby6Z5xYUM1leqgyo4RH7qJ-cqvNfqZuLOgBl85x17BTXShIxCOqRGgP2gRtbDPubcMcvA/exec";

document.getElementById("date").value = new Date().toISOString().split("T")[0];

function submitData(){
  document.getElementById("loading").style.display="flex";

  const data = {
    date: date.value,
    staff: staff.value,
    seller: seller.value,
    type: type.value,
    amount: amount.value,
    device: device.value,
    deviceAmount: deviceAmount.value,
    credit: credit_field.value
  };

  fetch(SCRIPT_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" }, // ‚úÖ ‡∏à‡∏∏‡∏î‡πÅ‡∏Å‡πâ error
    body:JSON.stringify(data)
  })
  .then(r=>r.json())
  .then(res=>{
    document.getElementById("loading").style.display="none";
    showPopup("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",true);
  })
  .catch(()=>{
    document.getElementById("loading").style.display="none";
    showPopup("‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß",false);
  });
}

function showPopup(msg,success){
  const p=document.getElementById("popup");
  document.getElementById("popupText").innerText=msg;
  p.className="popup "+(success?"success":"error");
  p.style.display="flex";
}

function closePopup(){
  document.getElementById("popup").style.display="none";
}
</script>

</body>
</html>
