à¸Šà¹ˆà¸§à¸¢à¹à¸à¹‰à¹„à¸‚à¸—à¸³à¹ƒà¸«à¹‰ sidebar à¹€à¸¡à¸™à¸¹à¸à¸¥à¸±à¸šà¹€à¸›à¹‡à¸™à¸›à¸à¸•à¸´à¸«à¸™à¹ˆà¸­à¸¢ à¸•à¸­à¸™à¸™à¸µà¹‰ à¹à¸ªà¸”à¸‡à¸œà¸¥ à¸‚à¸²à¸§à¸šà¹‰à¸²à¸‡ à¸”à¸³à¸šà¹‰à¸²à¸‡ à¸‡à¸‡à¸¡à¸²à¸ à¸«à¹‰à¸²à¸¡à¹à¸à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸­à¸·à¹ˆà¸™à¸¢à¸à¹€à¸§à¹‰à¸™ à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¹€à¸¡à¸™à¸¹ 

<!DOCTYPE html>
<html lang="th">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>Performance Dashboard - SHOP</title>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
Â  Â Â 
Â  Â  <style>
Â  Â  Â  Â  :root {Â 
Â  Â  Â  Â  Â  Â  --primary: #5bb7aa;Â 
Â  Â  Â  Â  Â  Â  --bg: #f5f7fa;Â 
Â  Â  Â  Â  Â  Â  --text-dark: #2d3748;Â 
Â  Â  Â  Â  Â  Â  --white: #ffffff;Â 
Â  Â  Â  Â  Â  Â  --sidebar-width: 260px;Â 
Â  Â  Â  Â  Â  Â  --sidebar-bg: #1e293b;
Â  Â  Â  Â  Â  Â  --sidebar-hover: #334155;
Â  Â  Â  Â  Â  Â  --sidebar-text: #cbd5e1;
Â  Â  Â  Â  Â  Â  --success: #059669;
Â  Â  Â  Â  Â  Â  --danger: #dc2626;
Â  Â  Â  Â  Â  Â  --pdf: #e11d48;
Â  Â  Â  Â  Â  Â  --excel: #166534;
Â  Â  Â  Â  Â  Â  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
Â  Â  Â  Â  }
Â  Â  Â  Â  * { box-sizing: border-box; font-family: 'Kanit', sans-serif !important; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  html, body { margin: 0; padding: 0; width: 100%; background-color: var(--bg); color: var(--text-dark); min-height: 100vh; overflow-x: hidden; }
Â  Â  Â  Â  body { display: flex; }

Â  Â  Â  Â  /* ===== GLOBAL RESET & SIDEBAR STRUCTURE ===== */
Â  Â  Â  Â  * { box-sizing: border-box; font-family: 'Kanit', sans-serif !important; }
Â  Â  Â  Â  body { margin: 0; background: #f8fafc; padding-bottom: 80px; color: #334155; -webkit-font-smoothing: antialiased; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .top-toggle { position: fixed; top: 15px; left: 15px; z-index: 1400; width: 45px; height: 45px; border-radius: 12px; border: none; background: #1e293b; color: #fff; font-size: 20px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; align-items: center; justify-content: center; }
Â  Â  Â  Â  @media(min-width:769px) { .top-toggle { display: none; } }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .sidebar { position: fixed; top: 0; left: 0; width: 260px; height: 100vh; background: #1e293b; color: #fff; overflow-y: auto; transform: translateX(-260px); transition: all .3s cubic-bezier(0.4, 0, 0.2, 1); z-index: 2000; }
Â  Â  Â  Â  .sidebar.show { transform: translateX(0); }
Â  Â  Â  Â  .content { padding: 80px 20px 40px; transition: margin-left .3s; }
Â  Â  Â  Â  @media(min-width:769px) { .sidebar { transform: translateX(0); } .content { margin-left: 260px; } }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.6); display: none; backdrop-filter: blur(4px); z-index: 1500; }
Â  Â  Â  Â  .overlay.show { display: block; }

Â  Â  Â  Â  /* ===== [FIXED] SIDEBAR INTERNAL MENU STYLE ===== */
Â  Â  Â  Â  .sidebar-header { padding: 25px 20px; font-size: 18px; font-weight: 600; background: #0f172a; color: #fff; border-bottom: 1px solid rgba(255,255,255,0.05); }
Â  Â  Â  Â  .menu { display: flex; flex-direction: column; padding: 10px 0; }
Â  Â  Â  Â  .item { border-bottom: 1px solid rgba(255,255,255,0.03); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* à¸ªà¹„à¸•à¸¥à¹Œà¸›à¸¸à¹ˆà¸¡à¹€à¸¡à¸™à¸¹à¸«à¸¥à¸±à¸ + à¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œà¹€à¸¡à¸²à¸ªà¹Œà¸Šà¸µà¹‰à¹à¸¥à¹‰à¸§à¸‚à¸¢à¸±à¸š */
Â  Â  Â  Â  .menu a, .menu .drop-btn {Â 
Â  Â  Â  Â  Â  Â  width: 100%; min-height: 50px; padding: 12px 20px; background: none; border: none;Â 
Â  Â  Â  Â  Â  Â  color: #cbd5e1; text-align: left; font-size: 15px; cursor: pointer; display: flex;Â 
Â  Â  Â  Â  Â  Â  align-items: center; text-decoration: none; transition: all 0.3s ease;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  /* à¹à¸à¹‰à¹„à¸‚à¸ˆà¸¸à¸”à¸™à¸µà¹‰: à¹€à¸¡à¸²à¸ªà¹Œà¸Šà¸µà¹‰à¹à¸¥à¹‰à¸§à¸‚à¸¢à¸±à¸šà¹„à¸›à¸—à¸²à¸‡à¸‚à¸§à¸² */
Â  Â  Â  Â  .menu a:hover, .menu .drop-btn:hover { background: #334155; color: #fff; padding-left: 30px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* à¹€à¸¡à¸™à¸¹à¸¢à¹ˆà¸­à¸¢ + à¹€à¸¡à¸²à¸ªà¹Œà¸Šà¸µà¹‰à¹à¸¥à¹‰à¸§à¸‚à¸¢à¸±à¸š */
Â  Â  Â  Â  .sub { display: none; background: #0f172a; padding: 5px 0; }
Â  Â  Â  Â  .item.open .sub { display: block; }
Â  Â  Â  Â  .sub a { padding-left: 45px; font-size: 14px; color: #94a3b8; min-height: 40px; transition: all 0.3s ease; }
Â  Â  Â  Â  .sub a:hover { color: #5bbf8a; padding-left: 55px; }

Â  Â  Â  Â  /* à¸¥à¸¹à¸à¸¨à¸£ */
Â  Â  Â  Â  .arrow { margin-left: auto; transition: 0.3s; font-size: 10px; opacity: 0.6; }
Â  Â  Â  Â  .item.open .arrow { transform: rotate(90deg); }


Â  Â  Â  Â  /* ===== MAIN CONTENT AREA ===== */
Â  Â  Â  Â  .main-content {Â 
Â  Â  Â  Â  Â  Â  flex-grow: 1;Â 
Â  Â  Â  Â  Â  Â  margin-left: var(--sidebar-width);
Â  Â  Â  Â  Â  Â  padding: 15px;Â 
Â  Â  Â  Â  Â  Â  width: calc(100% - var(--sidebar-width));
Â  Â  Â  Â  Â  Â  transition: var(--transition);
Â  Â  Â  Â  }

Â  Â  Â  Â  body.collapsed #sidebar-container { transform: translateX(calc(var(--sidebar-width) * -1)); }
Â  Â  Â  Â  body.collapsed .main-content { margin-left: 0; width: 100%; }

Â  Â  Â  Â  @media (max-width: 900px) {
Â  Â  Â  Â  Â  Â  #sidebar-container { transform: translateX(calc(var(--sidebar-width) * -1)); }
Â  Â  Â  Â  Â  Â  .main-content { margin-left: 0; width: 100%; padding: 10px; }
Â  Â  Â  Â  Â  Â  body.show-sidebar #sidebar-container { transform: translateX(0); }
Â  Â  Â  Â  Â  Â  body.collapsed #sidebar-container { transform: translateX(calc(var(--sidebar-width) * -1)); }
Â  Â  Â  Â  }

Â  Â  Â  Â  .overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.6); display: none; backdrop-filter: blur(4px); z-index: 1500; }
Â  Â  Â  Â  .overlay.show { display: block; }

Â  Â  Â  Â  /* ===== BUTTONS HOVER ===== */
Â  Â  Â  Â  .btn-fetch, .btn-pdf, .btn-excel {
Â  Â  Â  Â  Â  Â  transition: var(--transition);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-fetch:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(91, 183, 170, 0.4); filter: brightness(1.1); }
Â  Â  Â  Â  .btn-pdf:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(225, 29, 72, 0.4); filter: brightness(1.1); }
Â  Â  Â  Â  .btn-excel:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(22, 101, 52, 0.4); filter: brightness(1.1); }
Â  Â  Â  Â  .btn-fetch:active, .btn-pdf:active, .btn-excel:active { transform: translateY(0); }

Â  Â  Â  Â  /* ===== CARDS & TABLES ===== */
Â  Â  Â  Â  .container { max-width: 1200px; margin: 0 auto; width: 100%; }
Â  Â  Â  Â  .header-bar {Â 
Â  Â  Â  Â  Â  Â  background: var(--white); padding: 15px 20px; border-radius: 14px; display: flex;Â 
Â  Â  Â  Â  Â  Â  justify-content: space-between; align-items: center; margin-bottom: 20px;Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); flex-wrap: wrap; gap: 15px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .action-group { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
Â  Â  Â  Â  #daySelect { padding: 10px 16px; border-radius: 10px; border: 1px solid #e2e8f0; font-size: 16px; background-color: #f8fafc; cursor: pointer; transition: var(--transition); flex-grow: 1; }
Â  Â  Â  Â  #daySelect:hover { border-color: var(--primary); }

Â  Â  Â  Â  .btn-fetch { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 8px; }
Â  Â  Â  Â  .btn-pdf { background: var(--pdf); color: white; border: none; padding: 10px 16px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 8px; }
Â  Â  Â  Â  .btn-excel { background: var(--excel); color: white; border: none; padding: 10px 16px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 8px; }

Â  Â  Â  Â  .main-grid { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 15px; }
Â  Â  Â  Â  @media (max-width: 900px) { .main-grid { grid-template-columns: 1fr; } .action-group { width: 100%; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; } .btn-fetch { grid-column: span 2; } }

Â  Â  Â  Â  #dashboardData { display: none; animation: fadeIn 0.5s ease; }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

Â  Â  Â  Â  .card { background: var(--white); border-radius: 15px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.03); border: 1px solid #edf2f7; margin-bottom: 15px; transition: var(--transition); }
Â  Â  Â  Â  .card:hover { box-shadow: 0 8px 20px rgba(0,0,0,0.06); }
Â  Â  Â  Â  .card-header { padding: 12px 18px; color: white; font-weight: 600; background: var(--primary); display: flex; justify-content: space-between; font-size: 18px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .table-wrapper { width: 100%; overflow-x: auto; }
Â  Â  Â  Â  table { width: 100%; border-collapse: collapse; }
Â  Â  Â  Â  th { padding: 15px; text-align: left; font-size: 16px; background: #fafbfc; border-bottom: 2px solid #edf2f7; }
Â  Â  Â  Â  td { padding: 12px 15px; border-bottom: 1px solid #f7fafc; font-size: 15px; transition: background 0.2s; }
Â  Â  Â  Â  tr:hover td { background: #f8fafc; }
Â  Â  Â  Â  .text-right { text-align: right; }
Â  Â  Â  Â  .row-summary { background-color: rgba(91, 183, 170, 0.1); }
Â  Â  Â  Â  .row-summary td { font-weight: 700 !important; color: #1a202c; border-bottom: 2px solid var(--primary); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .bottom-stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; padding: 15px; background: #fafbfc; border-top: 1px solid #edf2f7; }
Â  Â  Â  Â  .stat-item { background: #ffffff; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; border-left: 6px solid var(--primary); transition: var(--transition); }
Â  Â  Â  Â  .stat-item:hover { transform: scale(1.02); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
Â  Â  Â  Â  .stat-main { font-size: 24px; font-weight: 800; }
Â  Â  Â  Â  .stat-sub-val { color: #dc2626; font-weight: 700; }

Â  Â  Â  Â  .target-group-header { padding: 10px 15px; font-weight: 600; color: white; }
Â  Â  Â  Â  .bg-amber { background: #ffb100; } .bg-orange { background: #ff5722; } .bg-slate { background: #4a5568; } .bg-teal { background: #38b2ac; }
Â  Â  Â  Â  .loading { position: fixed; inset: 0; background: rgba(255,255,255,0.8); display: none; justify-content: center; align-items: center; z-index: 3000; font-weight: 600; }

Â  Â  Â  Â  .daily-table thead tr:first-child th { color: #ffffff; text-align: center; padding: 8px; }
Â  Â  Â  Â  .daily-table thead tr:last-child th { background: #f1f5f9; color: #475569; text-align: center; font-size: 12px; }
Â  Â  Â  Â  .daily-table td { text-align: center; border-right: 1px solid #f1f5f9; }
Â  Â  Â  Â  .val-actual { color: var(--primary); font-weight: 700; }
Â  Â  Â  Â  .val-diff { color: #dc2626; font-weight: 700; }
Â  Â  Â  Â  .v-sep { border-left: 2px solid #e2e8f0 !important; }
Â  Â  </style>
</head>
<body id="mainBody">

<div class="loading" id="loader">ğŸ”„ à¸à¸³à¸¥à¸±à¸‡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥...</div>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<aside id="sidebar-container">
Â  Â  <div class="sidebar-header">MENU</div>
Â  Â  <div class="menu">
Â  Â  Â  Â  <a href="index.html">ğŸ  à¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸</a>

Â  Â  Â  Â  <div class="item" id="menu-credit">
Â  Â  Â  Â  Â  Â  <button type="button" class="drop-btn" onclick="toggleDrop(this, 'credit')">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ“Š à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­ <span class="arrow">â–¶</span>
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <div class="sub">
Â  Â  Â  Â  Â  Â  Â  Â  <a href="https://docs.google.com/forms/d/e/1FAIpQLSerK-IQFH4StGmvrOxb8M2DOC9VyrToSycYBxWrzSVOq67SOw/viewform" target="_blank">ğŸ“ˆ à¸¥à¸‡à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="https://lookerstudio.google.com/reporting/8eee598b-7f10-4d88-8162-8ac554e50b9e" target="_blank">ğŸ“‘ Report à¸ªà¸´à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡</a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <a href="download.html">â¬‡ï¸ à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸”</a>

Â  Â  Â  Â  <div class="item" id="menu-branch">
Â  Â  Â  Â  Â  Â  <button type="button" class="drop-btn" onclick="toggleDrop(this, 'branch')">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ“ à¹€à¸‰à¸à¸²à¸°à¸›à¸£à¸°à¸Šà¸²à¸­à¸¸à¸—à¸´à¸¨ <span class="arrow">â–¶</span>
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <div class="sub">
Â  Â  Â  Â  Â  Â  Â  Â  <a href="schedule_dec25.html">ğŸ“† à¸•à¸²à¸£à¸²à¸‡à¸‡à¸²à¸™ à¸˜.à¸„. 25</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="schedule_jan26.html">ğŸ“† à¸•à¸²à¸£à¸²à¸‡à¸‡à¸²à¸™ à¸¡.à¸„. 26</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="mat.html">ğŸ“± à¹€à¸Šà¹‡à¸„ Mat à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="input_sale.html">âœï¸ à¸¥à¸‡à¸¢à¸­à¸”à¸‚à¸²à¸¢</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="report_sale.html">ğŸ“‘ à¸£à¸²à¸¢à¸‡à¸²à¸™à¸¢à¸­à¸”à¸‚à¸²à¸¢</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="reportsale_shop.html">ğŸ“‘ à¸£à¸²à¸¢à¸‡à¸²à¸™à¸¢à¸­à¸”à¸‚à¸²à¸¢ Shop</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="commission.html">ğŸ’° à¸„à¸³à¸™à¸§à¸“à¸„à¹ˆà¸²à¸„à¸­à¸¡</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="target.html">ğŸ†š Target à¸£à¸²à¸¢à¸šà¸¸à¸„à¸„à¸¥</a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</aside>

<main class="main-content">
Â  Â  <div class="container">
Â  Â  Â  Â  <div class="header-bar">
Â  Â  Â  Â  Â  Â  <div style="display:flex; align-items:center; gap:12px;">
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleSidebar()" style="background:var(--sidebar-bg); color:white; border:none; padding:10px 14px; border-radius:10px; cursor:pointer; transition: 0.3s;">â˜°</button>
Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="margin:0; font-size:18px; color:var(--primary);">Performance Report (SHOP)</h2>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="action-group">
Â  Â  Â  Â  Â  Â  Â  Â  <select id="daySelect">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">ğŸ“… à¹€à¸¥à¸·à¸­à¸à¸§à¸±à¸™à¸—à¸µà¹ˆ</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <script>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for(let i=1; i<=31; i++) document.write(`<option value="${i}">à¸§à¸±à¸™à¸—à¸µà¹ˆ ${i}</option>`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </script>
Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-fetch" onclick="loadData()">ğŸš€ à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-pdf" onclick="exportPDF()">ğŸ“„ PDF</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-excel" onclick="exportExcel()">ğŸ“Š Excel</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="noData" style="text-align: center; padding: 60px 20px; color: #a0aec0; background: white; border-radius: 20px; border: 2px dashed #e2e8f0;">
Â  Â  Â  Â  Â  Â  <p>à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¸§à¸±à¸™à¸—à¸µà¹ˆà¹à¸¥à¸°à¸à¸”à¸›à¸¸à¹ˆà¸¡ <b>"à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥"</b></p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="dashboardData">
Â  Â  Â  Â  Â  Â  <div class="card" id="dailyCard">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>ğŸ“… à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸£à¸²à¸¢à¸§à¸±à¸™ (à¸§à¸±à¸™à¸—à¸µà¹ˆ <span id="dailyDateNum"></span>)</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="labelStaff" style="font-size: 13px;"></span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="daily-table" id="tableDaily">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th rowspan="2" style="background:#4a5568;">à¸§à¸±à¸™à¸—à¸µà¹ˆ</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th colspan="2" class="bg-amber">New Post</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th colspan="2" class="bg-orange">BDBC</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th colspan="2" class="bg-slate">Apple</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th colspan="2" class="bg-teal">SmartPhone</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th colspan="2" style="background:#2d3748;">Total</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="v-sep">Actual</th><th>Diff</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="v-sep">Actual</th><th>Diff</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="v-sep">Actual</th><th>Diff</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="v-sep">Actual</th><th>Diff</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="v-sep">Post</th><th>Device</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="dailyBody"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="main-grid">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">ğŸ“ à¸ªà¸£à¸¸à¸›à¸¢à¸­à¸”à¸‚à¸²à¸¢: <span id="labelL"></span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableSummary">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr><th>Type à¸à¸²à¸£à¸‚à¸²à¸¢</th><th class="text-right">à¸¢à¸­à¸” PostPay</th><th class="text-right">à¸ˆà¸³à¸™à¸§à¸™</th></tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="summaryBody"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="bottom-stats-grid" id="bottomStats"></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="side-panel">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">ğŸ¯ Focus: <span id="labelR"></span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableFocus">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th>Target</th><th class="text-right">Actual</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="focusBody"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header" style="background:#2d3748;">ğŸ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="targetBody"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</main>

<script>
Â  Â  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzJ9BCs2yKC5WpbnCPgazovq0mUrxq2U0KbfoSJxtLdp3XTB1Mc3FTg1qFxcth6F9tbow/exec";Â 

Â  Â  // --- SIDEBAR LOGIC ---
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
Â  Â  Â  Â  if (isCollapsed && window.innerWidth > 900) {
Â  Â  Â  Â  Â  Â  document.getElementById('mainBody').classList.add('collapsed');
Â  Â  Â  Â  }
Â  Â  Â  Â  restoreMenuState();
Â  Â  });

Â  Â  function toggleSidebar() {
Â  Â  Â  Â  const body = document.getElementById('mainBody');
Â  Â  Â  Â  const overlay = document.getElementById('overlay');
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (window.innerWidth > 900) {
Â  Â  Â  Â  Â  Â  body.classList.toggle('collapsed');
Â  Â  Â  Â  Â  Â  localStorage.setItem('sidebarCollapsed', body.classList.contains('collapsed'));
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  body.classList.toggle('show-sidebar');
Â  Â  Â  Â  Â  Â  overlay.classList.toggle('show');
Â  Â  Â  Â  }
Â  Â  }

Â  Â  window.toggleDrop = function(btn, id) {
Â  Â  Â  Â  const item = btn.closest('.item');Â 
Â  Â  Â  Â  if (!item) return;
Â  Â  Â  Â  const isOpen = item.classList.toggle("open");
Â  Â  Â  Â  if (id) localStorage.setItem('menu-' + id, isOpen);
Â  Â  }

Â  Â  function restoreMenuState() {
Â  Â  Â  Â  const menus = ['credit', 'branch'];Â 
Â  Â  Â  Â  menus.forEach(id => {
Â  Â  Â  Â  Â  Â  if (localStorage.getItem('menu-' + id) === 'true') {
Â  Â  Â  Â  Â  Â  Â  Â  const menuEl = document.getElementById('menu-' + id);
Â  Â  Â  Â  Â  Â  Â  Â  if (menuEl) menuEl.classList.add('open');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  }

Â  Â  // --- DATA FETCHING LOGIC ---
Â  Â  async function loadData() {
Â  Â  Â  Â  const loader = document.getElementById('loader');
Â  Â  Â  Â  const selectedDay = document.getElementById('daySelect').value;
Â  Â  Â  Â  if(!selectedDay) return alert("à¹‚à¸›à¸£à¸”à¹€à¸¥à¸·à¸­à¸à¸§à¸±à¸™à¸—à¸µà¹ˆ");

Â  Â  Â  Â  loader.style.display = 'flex';
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const fetchUrl = `${SCRIPT_URL}?sheetName=${encodeURIComponent("SHOP")}&targetDay=${selectedDay}`;
Â  Â  Â  Â  Â  Â  const res = await fetch(fetchUrl);
Â  Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  Â  if(data.result === "success") {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('labelL').innerText = data.staffName;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('labelR').innerText = data.staffName;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('labelStaff').innerText = data.staffName;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('dailyDateNum').innerText = selectedDay;

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('summaryBody').innerHTML = data.summary.map(r => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const isTotal = r[0].includes("à¸£à¸§à¸¡à¸¢à¸­à¸”");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<tr class="${isTotal?'row-summary':''}"><td>${r[0]}</td><td class="text-right">${r[1]}</td><td class="text-right">${r[2]}</td></tr>`;
Â  Â  Â  Â  Â  Â  Â  Â  }).join('');

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('focusBody').innerHTML = data.focus
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .filter(r => r[0] && r[0] !== "Target")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .map(r => `<tr><td>${r[0]}</td><td class="text-right" style="color:#dc2626; font-weight:700;">${r[1]}</td></tr>`).join('');

Â  Â  Â  Â  Â  Â  Â  Â  const tDiv = document.getElementById('targetBody');
Â  Â  Â  Â  Â  Â  Â  Â  tDiv.innerHTML = "";
Â  Â  Â  Â  Â  Â  Â  Â  data.targets.forEach(r => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(r[0].includes("à¸„à¸³à¸™à¸§à¸“ Target")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let cls = r[0].includes("NEW") ? "bg-amber" : r[0].includes("BDBC") ? "bg-orange" : r[0].includes("Apple") ? "bg-slate" : "bg-teal";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tDiv.innerHTML += `<div class="target-group-header ${cls}">${r[0]}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if(r[0] && r[0] !== "Target") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tDiv.innerHTML += `<div style="display:flex;justify-content:space-between;padding:12px 18px;border-bottom:1px solid #f1f5f9;"><span>${r[0]}</span><b>${r[1]}</b></div>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  const s = data.topStats;
Â  Â  Â  Â  Â  Â  Â  Â  const stats = [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { l: s[0][0], v: s[1][0], d: s[1][1], c: '#ffb100' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { l: s[0][2], v: s[1][2], d: s[1][3], c: '#ff5722' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { l: s[0][4], v: s[1][4], d: s[1][5], c: '#4a5568' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { l: s[0][6], v: s[1][6], d: s[1][7], c: '#38b2ac' }
Â  Â  Â  Â  Â  Â  Â  Â  ];
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('bottomStats').innerHTML = stats.map(i => `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-item" style="border-left-color:${i.c}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small style="font-weight:600; color:#4a5568;">${i.l}</small><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;justify-content:space-between;align-items:flex-end; margin-top:5px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="stat-main">${i.v}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-right"><small style="font-size:10px; color:#718096;">à¸‚à¸²à¸”/à¹€à¸à¸´à¸™</small><br><span class="stat-sub-val">${i.d}</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`).join('');

Â  Â  Â  Â  Â  Â  Â  Â  if(data.dailyRow) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dr = data.dailyRow;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('dailyBody').innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr><td style="background:#f8fafc;">${dr[0]}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="v-sep val-actual">${dr[1]}</td><td class="val-diff">${dr[2]}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="v-sep val-actual">${dr[3]}</td><td class="val-diff">${dr[4]}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="v-sep val-actual">${dr[5]}</td><td class="val-diff">${dr[6]}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="v-sep val-actual">${dr[7]}</td><td class="val-diff">${dr[8]}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="v-sep"><b>${dr[9]}</b></td><td><b>${dr[10]}</b></td></tr>`;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('dashboardData').style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('noData').style.display = 'none';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  alert("à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸”à¹‰ à¹‚à¸›à¸£à¸”à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² App Script à¸‚à¸­à¸‡à¸„à¸¸à¸“");
Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  loader.style.display = 'none';
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function exportPDF() {
Â  Â  Â  Â  const element = document.getElementById('dashboardData');
Â  Â  Â  Â  html2pdf().set({ margin: 5, filename: 'Performance_Report.pdf', jsPDF: { orientation: 'landscape' } }).from(element).save();
Â  Â  }

Â  Â  function exportExcel() {
Â  Â  Â  Â  const wb = XLSX.utils.book_new();
Â  Â  Â  Â  const ws = XLSX.utils.table_to_sheet(document.getElementById('tableSummary'));
Â  Â  Â  Â  XLSX.utils.book_append_sheet(wb, ws, "Summary");
Â  Â  Â  Â  XLSX.writeFile(wb, "Performance_Report.xlsx");
Â  Â  }
</script>
</body>
</html>
