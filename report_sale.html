<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* ‡∏à‡∏±‡∏î‡πÅ‡∏ï‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á */
        * { box-sizing: border-box; font-family: 'Kanit', sans-serif !important; }
        body { margin: 0; background: #f8fafc; color: #334155; }
        .report-card { max-width: 600px; margin: 40px auto; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        select { width: 100%; padding: 12px; border-radius: 10px; border: 2px solid #e2e8f0; margin-bottom: 20px; font-size: 16px; }
        .btn-fetch { width: 100%; padding: 15px; border: none; background: #1e293b; color: white; border-radius: 10px; font-weight: 600; cursor: pointer; transition: 0.3s; }
        .btn-fetch:hover { background: #334155; }
        
        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; display: none; }
        th { background: #4db6ac; color: white; padding: 12px; border: 1px solid #e2e8f0; }
        td { padding: 10px; border: 1px solid #e2e8f0; text-align: center; }
        .row-new { background: #c8e6c9 !important; font-weight: 600; } /* ‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î New */
        .row-bdbc { background: #d1ecf1 !important; font-weight: 600; } /* ‡πÅ‡∏ñ‡∏ß‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î BDBC */
        #loader { text-align: center; display: none; margin: 15px; }
    </style>
</head>
<body>

<div class="report-card">
    <h2 style="text-align:center">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h2>
    <select id="staffSelect">
        <option value="‡∏ô‡∏ß‡∏û‡∏•2">üë§ ‡∏ô‡∏ß‡∏û‡∏•</option>
        <option value="‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£2">üë§ ‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£</option>
        <option value="‡∏Å‡∏£‡∏ó‡∏±‡∏Å‡∏©‡πå2">üë§ ‡∏Å‡∏£‡∏ó‡∏±‡∏Å‡∏©‡πå</option>
    </select>
    <button class="btn-fetch" onclick="getPersonalSales()">üîÑ ‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
    
    <div id="loader">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>

    <table id="reportTable">
        <thead>
            <tr id="headerTitle"><th colspan="3">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î</th></tr>
            <tr style="background:#f1f5f9; color: #333;">
                <th>Type ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</th><th>‡∏¢‡∏≠‡∏î PostPay</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            </tr>
        </thead>
        <tbody id="reportData"></tbody>
    </table>
</div>

<script>
    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy ‡πÉ‡∏´‡∏°‡πà
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxjK2--2Ka0kxNglF1-HnonTWYTKL3JnzVk8wGbZrg1r4tS66slONjQyrA4K069bvXE4A/exec"; 

    async function getPersonalSales() {
        const sheetName = document.getElementById('staffSelect').value;
        const staffName = document.getElementById('staffSelect').options[document.getElementById('staffSelect').selectedIndex].text;
        const loader = document.getElementById('loader');
        const table = document.getElementById('reportTable');
        const tbody = document.getElementById('reportData');
        
        loader.style.display = 'block';
        table.style.display = 'none';

        try {
            const response = await fetch(`${SCRIPT_URL}?sheetName=${encodeURIComponent(sheetName)}`);
            const result = await response.json();
            
            if (result.result === "error") throw new Error(result.error);

            document.getElementById('headerTitle').innerHTML = `<th colspan="3">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î ${staffName}</th>`;
            tbody.innerHTML = "";

            result.values.forEach(row => {
                if(!row[0]) return;
                const tr = document.createElement('tr');
                
                // ‡πÉ‡∏™‡πà‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö
                if(row[0].includes("‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î New")) tr.className = 'row-new';
                if(row[0].includes("‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î BDBC")) tr.className = 'row-bdbc';
                
                row.forEach(cell => {
                    const td = document.createElement('td');
                    td.innerText = cell || "0";
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            table.style.display = 'table';
        } catch (e) {
            // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Error ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏à‡∏≠
            alert("‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + e.message);
        } finally {
            loader.style.display = 'none';
        }
    }
</script>
</body>
</html>
