<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Target BigC Prachauthit</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* CSS ‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏° (‡∏ï‡∏±‡∏î‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö) */
        * { box-sizing: border-box; font-family: 'Kanit', sans-serif !important; }
        body { margin: 0; background: #f8fafc; padding-bottom: 100px; }
        .top-toggle { position: fixed; top: 15px; left: 15px; z-index: 1400; width: 45px; height: 45px; border-radius: 12px; border: none; background: #1e293b; color: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .sidebar { position: fixed; top: 0; left: 0; width: 260px; height: 100vh; background: #1e293b; color: #fff; transform: translateX(-260px); transition: 0.3s; z-index: 2000; overflow-y: auto; }
        .sidebar.show { transform: translateX(0); }
        .content { padding: 80px 20px; transition: margin-left .3s; }
        @media(min-width:769px) { .sidebar { transform: translateX(0); } .content { margin-left: 260px; } .top-toggle { display: none; } }
        .target-card { background: #fff; border-radius: 24px; padding: 25px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); margin-bottom: 20px; border-top: 6px solid #3b82f6; }
        input[type="text"] { border: 1.5px solid #e2e8f0; border-radius: 8px; padding: 5px 10px; width: 120px; text-align: right; background: #f8fafc; pointer-events: none; }
        input.editable { background: #fff !important; pointer-events: auto !important; border-color: #3b82f6 !important; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; background: #cbd5e1; margin-right: 5px; }
        .online { background: #22c55e !important; box-shadow: 0 0 8px rgba(34,197,94,0.5); }
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 3000; backdrop-filter: blur(5px); }
        .modal-content { background: #fff; padding: 30px; border-radius: 20px; text-align: center; width: 320px; }
    </style>
</head>
<body>

<div id="pwdModal" class="modal">
    <div class="modal-content">
        <h3>üîë ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h3>
        <input type="password" id="pwdInput" style="width:100%; padding:12px; margin-bottom:20px; text-align:center;">
        <button onclick="checkPassword()" style="width:100%; padding:12px; background:#1e293b; color:#fff; border:none; border-radius:10px;">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>
</div>

<button class="top-toggle" onclick="toggleSidebar()">‚ò∞</button>
<aside class="sidebar" id="sidebar"></aside>

<main class="content">
    <div style="text-align:center; margin-bottom:30px;">
        <h2>Target BigC Prachauthit</h2>
        <p><span id="sync-status" class="status-dot"></span> <span id="status-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></p>
        <button id="btn-edit" onclick="openModal('edit')" style="padding:10px 20px; border-radius:10px; border:none; background:#1e293b; color:#fff;">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</button>
        <button id="btn-save" onclick="saveBulk()" style="display:none; padding:10px 20px; border-radius:10px; border:none; background:#22c55e; color:#fff;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>

    <div class="target-card">
        <h3 style="margin-top:0;">Postpay</h3>
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;"><span>‡∏ô‡∏ß‡∏û‡∏• (New)</span><input type="text" id="pp_nawa_n"></div>
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;"><span>‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£ (New)</span><input type="text" id="pp_piya_n"></div>
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;"><span>‡∏ô‡∏ß‡∏û‡∏• (Ext)</span><input type="text" id="pp_nawa_e"></div>
        <div style="display:flex; justify-content:space-between;"><span>‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏£ (Ext)</span><input type="text" id="pp_piya_e"></div>
    </div>
    </main>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxPhDyBiF-uhY1b3qAoOc_34MFfNIApwlxwYX6766g4vEe45KQOwc3Ws8OdL59eNF3q2Q/exec";

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (Batch Read) - ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
    async function loadData() {
        try {
            const res = await fetch(`${SCRIPT_URL}?action=read`);
            const data = await res.json();
            Object.keys(data).forEach(id => {
                const el = document.getElementById(id);
                if (el) el.value = data[id];
            });
            document.getElementById('sync-status').classList.add('online');
            document.getElementById('status-text').innerText = "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô";
        } catch (e) { console.error("Load failed"); }
    }

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (Batch Write) - ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
    async function saveBulk() {
        const btn = document.getElementById('btn-save');
        btn.innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";
        btn.disabled = true;

        const payload = {};
        document.querySelectorAll('input.editable').forEach(input => {
            payload[input.id] = input.value;
        });

        try {
            await fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify(payload)
            });
            alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
            location.reload();
        } catch (e) { alert("‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"); btn.disabled = false; }
    }

    function openModal() { document.getElementById('pwdModal').style.display='flex'; }
    function checkPassword() {
        if(document.getElementById('pwdInput').value === "Bbb#%0285134679") {
            document.querySelectorAll('input[type="text"]').forEach(i => i.classList.add('editable'));
            document.getElementById('btn-edit').style.display='none';
            document.getElementById('btn-save').style.display='inline-block';
            document.getElementById('pwdModal').style.display='none';
        } else { alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î"); }
    }

    function toggleSidebar() { document.getElementById('sidebar').classList.toggle('show'); }

    // ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    window.onload = () => { loadData(); };
</script>
</body>
</html>
